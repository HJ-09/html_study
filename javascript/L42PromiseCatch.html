<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>프라미스 객체에서 예외 위임</title>
</head>
<body>
    <h1>프라미스 객체에서 예외 위임</h1>

    <script>

    /*  let e=new Error();
        throw e;
        //Error 객체를 만든다고 오류가 발생하지 않음. throw 해야 오류 발생..!  */

        let a=10;
        //let b=20; //resolve 결과
        let b='이십'; //reject 결과. 파싱할 수 없어송~
        new Promise((resolve, reject)=>{
            let sum=(+a)+(+b); //NaN가 아니면 resolve, NaN이면 reject
            //isNaN는 NaN일 수도 있는 데이터, Number.isNaN는 이미 NaN이냐고 묻는거임.
            //isNaN('십') 검사 ⇒ true
            //Number.isNaN('십') 검사 ⇒ false
            if (Number.isNaN(sum)){ //a나 b 둘 중 하나가 NaN냐고
                //reject('a나 b 둘 중 하나가 NaN?!'); //⇒ reject 안 해도 에러캐치가능함. reject는 명ㅅㅣ적 선택임
                throw new Error('a나 b 둘 중 하나가 NaN?! Error');
            }else {
                resolve(sum);
            }
        }).then((sum)=>{
            console.log('a+b는 '+sum);
        }).catch(err=>{
            console.log('catch: '+err.message);
        }) //a+b는 30


        ///async 함수에서 promise의 예외처리
       /* const run=async (n1,n2)=>{ // ->> 호이스팅 x //===async function run(){} ->> 호이스팅 o
            let result=await new Promise((resolve, reject)=>{
                let sum=(+n1)+(+n2);
                if (Number.isNaN(sum)){
                    reject('n1,n2 둘 중 NaN가 있습니다 ㅇ0ㅇ');
                }else {
                    resolve(sum);
                }
            })
            console.log('run\' result: '+result);
        }
        run(10,20); //30
        run('20',20); //40
        run('이십',20); //Uncaught (in promise) n1,n2 둘 중 NaN가 있습니다 ㅇ0ㅇ

        console.log('아녕'); //async는 비동기라서 위에 오류가 있어도 이 친구는 실행됨 ^^ */

        //오류내고 해결해볼게~
        const run=async (n1,n2)=>{
            try {
                let result=await new Promise((resolve, reject)=>{
                    let sum=(+n1)+(+n2);
                    if (Number.isNaN(sum)){
                        //reject(new Error('n1,n2 둘 중 NaN가 있습니다 ㅇ0ㅇ')); //Error 객체 받기.. 어디서 에러가 났는지 구체적으로 알려줌
                        throw (new Error('n1,n2 둘 중 NaN가 있습니다 ㅇ0ㅇ')); //throw로 reject 대체 가능
                    }else {
                        resolve(sum);
                    }
                })
                console.log('run\' result: '+result);

            }catch (e){
                console.log(e)
            }
        }
        run(10,20); //30
        run('20',20); //40
        run('이십',20); //Uncaught (in promise) n1,n2 둘 중 NaN가 있습니다 ㅇ0ㅇ

        console.log('할로');

    </script>
</body>
</html>